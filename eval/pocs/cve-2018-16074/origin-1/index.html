<!doctype html>

<html>
    <body>
        <iframe id="frame" src="" sandbox="allow-scripts allow-popups"></iframe>

        <script>
            let inner = `
<html>
<body>
    <p>Data 127.0.0.1</p>
    <script>
        console.log('in data url ', location.origin);
        let text = \`<html><body><p>Blob 127.0.0.1</p><script>
console.log('in blob url', location.origin);
function check_site_violation(fetch, exec, token) {
    try {
        if (IPCFuzzer.check_isolation(fetch)) {
            console.log('[process-' + token + ']', '[UXSS]', fetch);
            return true;
        }
    } catch (error) {
        console.log('Process Isolation Check: ' + error);
    }
}
try {
    var _origin_fetch_ = 'http://127.0.0.1:8080';
    var _origin_exec_ = location.origin;
    check_site_violation(_origin_fetch_, _origin_exec_, 'a');
} catch (e) { }
<\\/script></body></html>
\`
        function check_site_violation(fetch, exec, token) {
            try {
                if (IPCFuzzer.check_isolation(fetch)) {
                    console.log('[process-' + token + ']', '[UXSS]', fetch);
                    return true;
                }
            } catch (error) {
                console.log('Process Isolation Check: ' + error);
            }
        }
        try {
            var _origin_fetch_ = 'http://127.0.0.1:8080';
            var _origin_exec_ = location.origin;
            check_site_violation(_origin_fetch_, _origin_exec_, 'a');
        } catch (e) { }

        var blob = new Blob([text], { type: 'text/html' });
        var url = URL.createObjectURL(blob);
        location.href = url;
        // window.open(url);
    <\/script>

</body>
</html>
`;

            inner = inner.replace("\n", "");
            dataUrl = "data:text/html," + encodeURIComponent(inner);
            document.getElementById("frame").src = dataUrl;
        </script>
    </body>
</html>
